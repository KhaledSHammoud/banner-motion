<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SaudaÃ§Ã£o</title>
<style>
html, body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  background-color: black;
}
#banner {
  position: absolute;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  white-space: nowrap;
  font-weight: bold;
  user-select: none;
}
</style>
</head>
<body>
<div id="banner">CARREGANDO...</div>
<script>
function getParams() {
  const query = document.URL.split("?")[1] || "";
  return new URLSearchParams(query);
}
function addAlpha(color, opacity) {
  const clean = color.replace("#","");
  const alpha = Math.round(Math.min(Math.max(opacity,0),1)*255)
    .toString(16).padStart(2,"0").toUpperCase();
  return "#"+clean+alpha;
}
function chooseFont(f) {
  switch(parseInt(f)){
    case 1: return "Serif";
    case 2: return "Monospace";
    case 3: return "Cursive";
    case 4: return "Fantasy";
    default: return "Sans-Serif";
  }
}
function hexToRgb(hex) {
  const r = parseInt(hex.substr(1,2),16);
  const g = parseInt(hex.substr(3,2),16);
  const b = parseInt(hex.substr(5,2),16);
  return {r,g,b};
}
function getBrightness(hex) {
  const {r,g,b} = hexToRgb(hex);
  return (r*299 + g*587 + b*114) / 1000;
}
/* ========= ParÃ¢metros ========= */
const p = getParams();
let msg = p.get("n") || p.get("text") || "BEM-VINDO [membername]";
let membername = p.get("membername") || "";
msg = msg.replace("[membername]", membername);
const textColor = "#" + (p.get("c") || p.get("color") || "FFFF00").replace("#","");
const bgColor = "#" + (p.get("b") || p.get("bgcolor") || "000000").replace("#","");
const bgOpacity = parseFloat(p.get("o") || p.get("opacity")) || 0; // âœ… FUNDO (ANTIGO)
const decoColor = "#" + (p.get("d") || p.get("deco") || textColor).replace("#",""); // âž• NOVO
const decoOpacity = parseFloat(p.get("do") || 0) || 0; // âž• NOVO: DECORAÃ‡ÃƒO
const fontType = p.get("f")||0;
const fontSize = parseInt(p.get("s") || p.get("size").replace("px","")) || 50;
const duration = parseFloat(p.get("w") || p.get("speed")) || 10;
const dir = (p.get("dir")||"left").toLowerCase();
const behavior = (p.get("behavior")||"scroll").toLowerCase();
const bgstyle = p.get("bgstyle") || "none";

/* ========= Elementos ========= */
const banner = document.getElementById("banner");
banner.textContent = msg;
banner.style.color = textColor;
banner.style.fontFamily = chooseFont(fontType);
banner.style.fontSize = fontSize+"px";
document.body.style.backgroundColor = addAlpha(bgColor, bgOpacity); // âœ… FUNDO (ANTIGO)

/* ========= ðŸ”¥ DECORAÃ‡Ã•ES - CORES + OPACIDADE INDEPENDENTES ========= */
function rgbaFromHex(hex, op) {
  const {r,g,b} = hexToRgb(hex);
  return `rgba(${r},${g},${b},${op})`;
}

if (bgstyle !== "none") {
  const bgBrightness = getBrightness(bgColor);
  const autoDecoOpacity = bgBrightness < 100 ? 0.6 : 0.2;
  const finalDecoOpacity = decoOpacity || autoDecoOpacity; // âž• USA &do= ou automÃ¡tico
  const decoRgba = rgbaFromHex(decoColor, finalDecoOpacity);
  
  switch (bgstyle) {
    case "stripes":
      document.body.style.backgroundImage = 
        `repeating-linear-gradient(45deg, ${decoRgba} 0px, ${decoRgba} 10px, transparent 10px, transparent 20px)`;
      break;
    case "dots":
      document.body.style.backgroundImage = 
        `radial-gradient(circle, ${decoRgba} 2px, transparent 2px)`;
      document.body.style.backgroundSize = "20px 20px";
      break;
    case "grid":
      document.body.style.backgroundImage = 
        `linear-gradient(to right, ${decoRgba} 1px, transparent 1px),
         linear-gradient(to bottom, ${decoRgba} 1px, transparent 1px)`;
      document.body.style.backgroundSize = "25px 25px";
      break;
  }
  document.body.style.backgroundRepeat = "repeat";
}

/* ========= Movimento ========= */
let vw = window.innerWidth;
let bw = 0;
let posX = 0;
let lastTime = null;
let reverse = false;
let speed = 0;
function recalc(){
  vw = window.innerWidth;
  bw = banner.offsetWidth;
  speed = (vw + bw)/duration;
  if(behavior==="slide" && !reverse){
    posX = (dir==="left") ? vw : -bw;
  } else {
    posX = (dir==="right") ? -bw : vw;
  }
}
function animate(ts){
  if(!lastTime) lastTime=ts;
  const dt = (ts - lastTime)/1000;
  lastTime = ts;
  const delta = speed*dt*(reverse?-1:1);
  posX += (dir==="left" ? -delta : delta);
  if(behavior==="scroll"){
    if(dir==="left" && posX<-bw) posX=vw;
    if(dir==="right" && posX>vw) posX=-bw;
  } else if(behavior==="alternate"){
    if(posX<-bw || posX>vw) reverse=!reverse;
  } else if(behavior==="slide"){
    if(dir==="left" && posX<-bw) posX=-bw;
    if(dir==="right" && posX>vw) posX=vw;
  }
  banner.style.left = posX+"px";
  requestAnimationFrame(animate);
}
window.addEventListener("resize", recalc);
window.addEventListener("load", () => {
  recalc();
  requestAnimationFrame(animate);
});
</script>
</body>
</html>
